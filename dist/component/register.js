define(["require", "exports", "./visit", "./bind"], function (require, exports, visit_1, bind_1) {
    function createProto(target) {
        var proto = Object.create(HTMLElement.prototype);
        var t = new target();
        for (var key in t) {
            proto[key] = t[key];
        }
        return proto;
    }
    function createdCallback(template) {
        var _this = this;
        if (!template)
            return;
        var shadow = this.createShadowRoot();
        var clone = document.importNode(template.content, true);
        shadow.appendChild(clone);
        visit_1.default(shadow, function (node) { bind_1.default(node, _this); });
    }
    function assignCallback(target, key, cb, args) {
        if (args === void 0) { args = []; }
        var original = target[key];
        target[key] = function () {
            cb.apply(this, args);
            typeof original === "function" ? original.apply(this, arguments) : '';
        };
    }
    function register(name, target, template) {
        var prototype = createProto(target);
        assignCallback(prototype, "createdCallback", createdCallback, [template]);
        document.registerElement(name, { prototype: prototype });
    }
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.default = register;
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudC9yZWdpc3Rlci50cyJdLCJuYW1lcyI6WyJjcmVhdGVQcm90byIsImNyZWF0ZWRDYWxsYmFjayIsImFzc2lnbkNhbGxiYWNrIiwicmVnaXN0ZXIiXSwibWFwcGluZ3MiOiI7SUFHQSxxQkFBcUIsTUFBVTtRQUM5QkEsSUFBSUEsS0FBS0EsR0FBR0EsTUFBTUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsU0FBU0EsQ0FBQ0EsQ0FBQ0E7UUFFakRBLElBQUlBLENBQUNBLEdBQUdBLElBQUlBLE1BQU1BLEVBQUVBLENBQUNBO1FBQ3JCQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNuQkEsS0FBS0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7UUFDckJBLENBQUNBO1FBRURBLE1BQU1BLENBQUNBLEtBQUtBLENBQUNBO0lBQ2RBLENBQUNBO0lBRUQseUJBQXlCLFFBQVk7UUFBckNDLGlCQVFDQTtRQVBBQSxFQUFFQSxDQUFBQSxDQUFDQSxDQUFDQSxRQUFRQSxDQUFDQTtZQUNaQSxNQUFNQSxDQUFDQTtRQUNSQSxJQUFJQSxNQUFNQSxHQUFHQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLEVBQUVBLENBQUNBO1FBQ3JDQSxJQUFJQSxLQUFLQSxHQUFHQSxRQUFRQSxDQUFDQSxVQUFVQSxDQUFDQSxRQUFRQSxDQUFDQSxPQUFPQSxFQUFFQSxJQUFJQSxDQUFDQSxDQUFDQTtRQUN4REEsTUFBTUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsS0FBS0EsQ0FBQ0EsQ0FBQ0E7UUFFMUJBLGVBQUtBLENBQUNBLE1BQU1BLEVBQUVBLFVBQUFBLElBQUlBLElBQUtBLGNBQVFBLENBQUNBLElBQUlBLEVBQUVBLEtBQUlBLENBQUNBLENBQUNBLENBQUFBLENBQUNBLENBQUNBLENBQUNBO0lBQ2hEQSxDQUFDQTtJQUVELHdCQUF3QixNQUFVLEVBQUUsR0FBVSxFQUFFLEVBQVcsRUFBRSxJQUFPO1FBQVBDLG9CQUFPQSxHQUFQQSxTQUFPQTtRQUNuRUEsSUFBSUEsUUFBUUEsR0FBR0EsTUFBTUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7UUFDM0JBLE1BQU1BLENBQUNBLEdBQUdBLENBQUNBLEdBQUdBO1lBQ2IsRUFBRSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7WUFDckIsT0FBTyxRQUFRLEtBQUssVUFBVSxHQUFHLFFBQVEsQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQztRQUN2RSxDQUFDLENBQUFBO0lBQ0ZBLENBQUNBO0lBRUQsa0JBQWtDLElBQVksRUFBRSxNQUFVLEVBQUUsUUFBWTtRQUV2RUMsSUFBSUEsU0FBU0EsR0FBR0EsV0FBV0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0E7UUFFcENBLGNBQWNBLENBQUNBLFNBQVNBLEVBQUVBLGlCQUFpQkEsRUFBRUEsZUFBZUEsRUFBRUEsQ0FBQ0EsUUFBUUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFFbkVBLFFBQVNBLENBQUNBLGVBQWVBLENBQUNBLElBQUlBLEVBQUVBLEVBQUNBLFdBQUFBLFNBQVNBLEVBQUNBLENBQUNBLENBQUNBO0lBQ3JEQSxDQUFDQTtJQVBEOzhCQU9DLENBQUEiLCJmaWxlIjoiY29tcG9uZW50L3JlZ2lzdGVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHZpc2l0IGZyb20gXCIuL3Zpc2l0XCI7XHJcbmltcG9ydCBiaW5kTm9kZSBmcm9tIFwiLi9iaW5kXCI7XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVQcm90byh0YXJnZXQ6YW55KTogYW55IHtcclxuXHRsZXQgcHJvdG8gPSBPYmplY3QuY3JlYXRlKEhUTUxFbGVtZW50LnByb3RvdHlwZSk7XHJcblx0XHJcblx0bGV0IHQgPSBuZXcgdGFyZ2V0KCk7XHJcblx0Zm9yICh2YXIga2V5IGluIHQpIHtcclxuXHRcdHByb3RvW2tleV0gPSB0W2tleV07XHJcblx0fVxyXG5cdFxyXG5cdHJldHVybiBwcm90bztcclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlZENhbGxiYWNrKHRlbXBsYXRlOmFueSk6dm9pZCB7XHJcblx0aWYoIXRlbXBsYXRlKVxyXG5cdFx0cmV0dXJuO1xyXG5cdGxldCBzaGFkb3cgPSB0aGlzLmNyZWF0ZVNoYWRvd1Jvb3QoKTtcclxuXHRsZXQgY2xvbmUgPSBkb2N1bWVudC5pbXBvcnROb2RlKHRlbXBsYXRlLmNvbnRlbnQsIHRydWUpO1xyXG5cdHNoYWRvdy5hcHBlbmRDaGlsZChjbG9uZSk7XHJcblx0XHJcblx0dmlzaXQoc2hhZG93LCBub2RlID0+IHtiaW5kTm9kZShub2RlLCB0aGlzKTt9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gYXNzaWduQ2FsbGJhY2sodGFyZ2V0OmFueSwga2V5OnN0cmluZywgY2I6RnVuY3Rpb24sIGFyZ3M9W10pOiB2b2lkIHtcclxuXHRsZXQgb3JpZ2luYWwgPSB0YXJnZXRba2V5XTtcclxuXHR0YXJnZXRba2V5XSA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0Y2IuYXBwbHkodGhpcywgYXJncyk7XHJcblx0XHR0eXBlb2Ygb3JpZ2luYWwgPT09IFwiZnVuY3Rpb25cIiA/IG9yaWdpbmFsLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgOiAnJztcclxuXHR9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHJlZ2lzdGVyIChuYW1lOiBzdHJpbmcsIHRhcmdldDphbnksIHRlbXBsYXRlOmFueSk6dm9pZCB7XHJcblx0XHJcblx0bGV0IHByb3RvdHlwZSA9IGNyZWF0ZVByb3RvKHRhcmdldCk7XHJcblx0XHJcblx0YXNzaWduQ2FsbGJhY2socHJvdG90eXBlLCBcImNyZWF0ZWRDYWxsYmFja1wiLCBjcmVhdGVkQ2FsbGJhY2ssIFt0ZW1wbGF0ZV0pO1xyXG5cdFxyXG5cdCg8YW55PiBkb2N1bWVudCkucmVnaXN0ZXJFbGVtZW50KG5hbWUsIHtwcm90b3R5cGV9KTtcclxufSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==